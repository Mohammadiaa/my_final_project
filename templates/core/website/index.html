{% extends 'base.html' %} 
{% load blog_extras %}
{% load humanize %}
{% load static %} 
{% block content %}

<div class="row tm-row">
  {% for post in posts %}
  <article class="col-12 col-md-6 tm-post">
    <hr class="tm-hr-primary" />

    <a
      href="{% url 'blog:single' post.pk %}"
      class="effect-lily tm-post-link tm-pt-60"
    >
      <div class="tm-post-link-inner">
        {% if post.image %}
        <img src="{{post.image.url}}" alt="{{post.title}}" class="img-fluid" />
        {% else %}
        <img
          src="{% static 'img/default.jpg' %}"
          alt="default"
          class="img-fluid"
        />
        {% endif %}
      </div>

      <h2 class="tm-pt-30 tm-color-primary tm-post-title">{{post.title}}</h2>
    </a>

    <p class="tm-pt-30">{{post.content|truncatewords:25}}</p>
    <div class="d-flex justify-content-between tm-pt-45">
      <span class="tm-color-primary">
        Tags: {% for tag in post.tags.all %}
        <a href="{% url 'blog:tag' tag.id %}">{{ tag.name }}</a>
        {% if not forloop.last %}, {% endif %} {% empty %} No tags {% endfor %}
      </span>

      <span class="tm-color-primary">
        {% if post.published_date %} {{ post.published_date|naturaltime  }}
        {%endif %}
      </span>
    </div>

    <hr />

    <div class="d-flex justify-content-between">
      <span>{{ post|approved_comments_count }} comments</span>
      <span>by <a href="{% url 'blog:author' post.author.pk %}"> {{ post.author.username }}</span></a>
    </div>
    <div class="d-flex justify-content-between">
      <span>{{ post.counted_view }} views</span>
    </div>
  </article>

  {% endfor %}
</div>
{% if posts.has_other_pages %}
<div class="row tm-row tm-mt-100 tm-mb-75">
  <div class="tm-prev-next-wrapper">
    {% if posts.has_previous %}
    <a
      href="?page={{ posts.previous_page_number }}"
      class="mb-2 tm-btn tm-btn-primary tm-prev-next tm-mr-20"
      >Prev</a
    >
    {% endif %} {% if posts.has_next %}
    <a
      href="?page={{ posts.next_page_number }}"
      class="mb-2 tm-btn tm-btn-primary tm-prev-next"
      >Next</a
    >
    {% endif %}
  </div>

  <div class="tm-paging-wrapper">
    <span class="d-inline-block mr-3">Page</span>
    <nav class="tm-paging-nav d-inline-block">
      <ul>
        {% for num in posts.paginator.page_range %} {% if posts.number == num %}
        <li class="tm-paging-item active">
          <a href="?page={{ num }}" class="mb-2 tm-btn tm-paging-link"
            >{{num}}</a
          >
        </li>
        {% else %}
        <li class="tm-paging-item">
          <a href="?page={{ num }}" class="mb-2 tm-btn tm-paging-link"
            >{{num}}</a
          >
        </li>
        {% endif %} {% endfor %}
      </ul>
    </nav>
  </div>
</div>
{% endif %} {% endblock %}
